<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="distribution" content="global"/>
<meta name="robots" content="follow, all"/>
<meta name="language" content="en"/>
<title>
Brady</title>
<meta name="generator" content="WordPress 3.9.9"/>
 
<link rel="shortcut icon" href="http://l3rady.com/page/2/wp-content/favicon.ico" type="image/x-icon"/>
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="../../feed/rss/index.html"/>
<link rel="alternate" type="text/xml" title="RSS .92" href="../../feed/rss/index.html"/>
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="../../feed/atom/index.html"/>
<link rel="pingback" href="../../xmlrpc.php"/>
<link rel='archives' title='March 2011' href='../../blog/2011/03/index.html'/>
<link rel='archives' title='January 2011' href='../../blog/2011/01/index.html'/>
<link rel='archives' title='October 2010' href='../../blog/2010/10/index.html'/>
<link rel='archives' title='September 2010' href='../../blog/2010/09/index.html'/>
<link rel='archives' title='October 2009' href='../../blog/2009/10/index.html'/>
<link rel='archives' title='September 2009' href='../../blog/2009/09/index.html'/>
<link rel='archives' title='February 2009' href='../../blog/2009/02/index.html'/>
<link rel='archives' title='October 2008' href='../../blog/2008/10/index.html'/>
<link rel='archives' title='September 2008' href='../../blog/2008/09/index.html'/>
<link rel='archives' title='August 2008' href='../../blog/2008/08/index.html'/>
<link rel='archives' title='June 2008' href='../../blog/2008/06/index.html'/>
<link rel='archives' title='May 2008' href='../../blog/2008/05/index.html'/>
<link rel='archives' title='February 2008' href='../../blog/2008/02/index.html'/>
<script type="text/javascript">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.5 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-25211555-1']);
				            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
<link rel='stylesheet' id='mt-shcore-style-css' href='../../wp-content/plugins/syntax-highlighter-mt/styles/shCore.css%3Fver=2.2.4.css' type='text/css' media='all'/>
<link rel='stylesheet' id='mt-theme-style-css' href='../../wp-content/plugins/syntax-highlighter-mt/styles/shThemeDefault.css%3Fver=2.2.4.css' type='text/css' media='all'/>
<script type='text/javascript' src='../../wp-content/plugins/syntax-highlighter-mt/scripts/shCore.js%3Fver=2.2.4'></script>
<script type='text/javascript' src='../../wp-content/plugins/syntax-highlighter-mt/scripts/shAutoloader.js%3Fver=2.2.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd"/>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml"/>
<meta name="generator" content="WordPress 3.9.9"/>
<link rel="StyleSheet" href="../../wp-content/themes/alphaready/style/resetCSS.css" type="text/css"/>
<link rel="StyleSheet" href="../../wp-content/themes/alphaready/style/alpha.css" type="text/css"/>
<!--[if lte IE 7.0]><link type="text/css" rel="stylesheet" href="/wp-content/themes/alphaready/style/alphaie7.css" /><![endif]-->
<!--[if lte IE 6.0]><link type="text/css" rel="stylesheet" href="/wp-content/themes/alphaready/style/alphaie6.css" /><![endif]-->
</head>
<body><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="l3rady.com",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
<div id="container">
<a href="../../index.html"><img src="../../wp-content/themes/alphaready/images/headerlogo.jpg" alt="Brady" title="Brady" border="0"/></a>
<div id="header-container">
<div id="slogan"><img src="../../wp-content/themes/alphaready/images/slogan.png" alt="A moan, a groan, my life story and how me, a technically minded person just can&#039;t seem to fit in with anybody." title="A moan, a groan, my life story and how me, a technically minded person just can&#039;t seem to fit in with anybody."/></div>
<div id="nav-container">
<ul id="navigation">
<li class='home' id='selected'><a href="../../index.html">HOME</a></li>
<li class='about'><a href="../../about-me.html">ABOUT ME</a></li>
<li class='webmail'><a href="http://webmail.alphaready.com">WEBMAIL</a></li>
<li class='sms'><a href="http://sms.alphaready.com">SMS GATEWAY</a></li>
<li class='proxy'><a href="http://proxy.alphaready.com">PROXY</a></li>
</ul>
<a href="../../cigarette.php.html"> </a>
</div>
</div>
<div id="content"> <div id="sidebar">
<ul id="ulside">
<li><h2 id="side01">ARCHIVES</h2>
<ul>
<li><a href='../../blog/2011/03/index.html'>March 2011</a></li>
<li><a href='../../blog/2011/01/index.html'>January 2011</a></li>
<li><a href='../../blog/2010/10/index.html'>October 2010</a></li>
<li><a href='../../blog/2010/09/index.html'>September 2010</a></li>
<li><a href='../../blog/2009/10/index.html'>October 2009</a></li>
<li><a href='../../blog/2009/09/index.html'>September 2009</a></li>
<li><a href='../../blog/2009/02/index.html'>February 2009</a></li>
<li><a href='../../blog/2008/10/index.html'>October 2008</a></li>
<li><a href='../../blog/2008/09/index.html'>September 2008</a></li>
<li><a href='../../blog/2008/08/index.html'>August 2008</a></li>
<li><a href='../../blog/2008/06/index.html'>June 2008</a></li>
<li><a href='../../blog/2008/05/index.html'>May 2008</a></li>
<li><a href='../../blog/2008/02/index.html'>February 2008</a></li>
</ul>
</li>
<li><h2 id="side02">CATEGORIES</h2>
<ul>
<li class="cat-item cat-item-8"><a href="../../blog/category/code-and-snippets/index.html" title="View all posts filed under Code and Snippets">Code and Snippets</a> (14)
<ul class='children'>
<li class="cat-item cat-item-18"><a href="../../blog/category/code-and-snippets/css/index.html" title="View all posts filed under CSS">CSS</a> (1)
</li>
<li class="cat-item cat-item-10"><a href="../../blog/category/code-and-snippets/html/index.html" title="View all posts filed under HTML">HTML</a> (3)
</li>
<li class="cat-item cat-item-11"><a href="../../blog/category/code-and-snippets/javascript/index.html" title="View all posts filed under JavaScript">JavaScript</a> (3)
</li>
<li class="cat-item cat-item-9"><a href="../../blog/category/code-and-snippets/php/index.html" title="View all posts filed under PHP">PHP</a> (8)
</li>
</ul>
</li>
<li class="cat-item cat-item-16"><a href="../../blog/category/how-to/index.html" title="View all posts filed under How to">How to</a> (1)
</li>
<li class="cat-item cat-item-6"><a href="../../blog/category/inner-geek/index.html" title="Don&#039;t enter here if you want some lite reading. This place is purly my inner geek talking.">Inner Geek</a> (4)
</li>
<li class="cat-item cat-item-14"><a href="../../blog/category/software/index.html" title="View all posts filed under Software">Software</a> (2)
</li>
</ul>
</li>
<li><h2 id="side03">META</h2>
<ul>
<li><a href="http://feeds.feedburner.com/l3rady/WyQw" title="Syndicate this site using RSS"><abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="../../wp-login.php.html">Log in</a></li>
</ul>
</li>
</ul>
</div>
<div id="main-content">
<div class="entry">
 
<h3 class="entrytitle" id="post-437"><a href="../../index.html%3Fp=437.html" rel="bookmark">Microsoft Exchange &#8211; Recover deleted items from Outlook</a></h3>
<div class="entrymeta">September 15th 2009 | Posted to <a href="../../blog/category/software/index.html" title="View all posts in Software" rel="category tag">Software</a> </div>
<div class="entrybody"><p>Have you ever emptied your deleted items folder in Microsoft Outlook and realised you really did need that email you just deleted?</p>
<p>Well your in luck as it can be recovered, providing that the Microsoft Exchange Server has been told to keep deleted emails for a certain period of time.</p>
<p>Firstly you need to make a registry edit on your local machine to make the option available to you in Outlook.</p>
<p>1) Close Outlook<br/>
2) Run Regedit<br/>
3) Navigate to HKEY_LOCAL_MACHINE\Software\Microsoft\Exchange\Client\Options<br/>
4) Add a new DWORD called <strong>DumpsterAlwaysOn</strong><br/>
5) Set the DWORD to 1.<br/>
6) Close Regedit and launch Outlook.<br/>
7) Go to Tools->Recover Deleted Items&#8230;</p>
<p>There we have it. If you are not happy making changes to your registry yourself then you can use the following reg file that will make the change for you</p>
<p>[HTML]<br/>
Windows Registry Editor Version 5.00</p>
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Exchange\Client\Options]<br/>
&#8220;DumpsterAlwaysOn&#8221;=dword:00000001<br/>
[/HTML]</p>
<p><a href="../../wp-content/uploads/2009/09/DumpsterAlwaysOn.reg">Download Reg File Here</a></p>
<p class="comments_link">
<a href="../../index.html%3Fp=437.html#respond" title="Comment on Microsoft Exchange &#8211; Recover deleted items from Outlook"><span class="dsq-postid" rel="437 http://l3rady.com/?p=437"><img src="../../wp-content/themes/alphaready/images/comments.gif" title="comments" alt="*"/> Comments(0)</span></a> </p>
</div>
 
</div>
<div class="entry">
 
<h3 class="entrytitle" id="post-435"><a href="../../index.html%3Fp=435.html" rel="bookmark">PHP &#8211; Get users SID from Active Directory via LDAP (objectsid)</a></h3>
<div class="entrymeta">September 15th 2009 | Posted to <a href="../../blog/category/code-and-snippets/php/index.html" title="View all posts in PHP" rel="category tag">PHP</a> </div>
<div class="entrybody"><p>Have you ever needed to read an AD users SID so you can use it as the unique identifier it is?</p>
<p>Well I did but when I read out objectsid from AD for a user I found a load of weird symbols. It turned out that the data outputted was binary data. So after some digging around to see how to translate the binary data to a human readable SID like S-1-5-21-823795046-756116320-56781596-16683 I got to work to write a PHP script that could do just that.</p>
<p>This is what I came up with:</p>
<p>[PHP]$suffix =&#8221;@sub.mydomain.co.uk&#8221;;<br/>
$base_dn = &#8220;dc=sub,dc=mydomain,dc=co,dc=uk&#8221;;<br/>
$server = &#8220;127.0.0.1&#8243;;</p>
<p>$USERNAME = &#8220;username&#8221;;<br/>
$PASSWORD = &#8220;password&#8221;;</p>
<p>$USERNAMETOSEARCH = &#8220;user to get sid&#8221;;</p>
<p>$ds = ldap_connect($server);<br/>
ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);<br/>
ldap_set_option($ds, LDAP_OPT_REFERRALS, 0);<br/>
$r = ldap_bind($ds, $USERNAME.$suffix, $PASSWORD);<br/>
$sr = ldap_search($ds, $base_dn, &#8220;(samaccountname=&#8221;.$USERNAMETOSEARCH.&#8221;)&#8221;);<br/>
$entries = ldap_get_entries($ds, $sr);</p>
<p>// All SID&#8217;s begin with S-<br/>
$sid = &#8220;S-&#8221;;<br/>
// Convert Bin to Hex and split into byte chunks<br/>
$sidinhex = str_split(bin2hex($entries[0]['objectsid'][0]), 2);<br/>
// Byte 0 = Revision Level<br/>
$sid = $sid.hexdec($sidinhex[0]).&#8221;-&#8221;;<br/>
// Byte 1-7 = 48 Bit Authority<br/>
$sid = $sid.hexdec($sidinhex[6].$sidinhex[5].$sidinhex[4].$sidinhex[3].$sidinhex[2].$sidinhex[1]);<br/>
// Byte 8 count of sub authorities &#8211; Get number of sub-authorities<br/>
$subauths = hexdec($sidinhex[7]);<br/>
//Loop through Sub Authorities<br/>
for($i = 0; $i < $subauths; $i++) {
	$start = 8 + (4 * $i);
	// X amount of 32Bit (4 Byte) Sub Authorities
	$sid = $sid.&#8221;-&#8221;.hexdec($sidinhex[$start+3].$sidinhex[$start+2].$sidinhex[$start+1].$sidinhex[$start]);
}

echo $sid;[/PHP]

Now this is written in PHP but I&#8217;m sure this code can be pretty much be translated to any other language.
</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=435.html#comments" title="Comment on PHP &#8211; Get users SID from Active Directory via LDAP (objectsid)"><span class="dsq-postid" rel="435 http://l3rady.com/?p=435"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(2)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2009/09/15/php-get-users-sid-from-active-directory-via-ldap-objectsid/"
    dc:identifier="http://l3rady.com/blog/2009/09/15/php-get-users-sid-from-active-directory-via-ldap-objectsid/"
    dc:title="PHP &#8211; Get users SID from Active Directory via LDAP (objectsid)"
    trackback:ping="http://l3rady.com/blog/2009/09/15/php-get-users-sid-from-active-directory-via-ldap-objectsid/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">14 September 2009</h2>-->
      <h3 class="entrytitle" id="post-432"><a href="../../index.html%3Fp=432.html" rel="bookmark">PHP &#8211; Active Directory &#8211; Reading UserAccountControl</a></h3>
      <div class="entrymeta">September 14th 2009 | Posted to <a href="../../blog/category/code-and-snippets/php/index.html" title="View all posts in PHP" rel="category tag">PHP</a> </div>
      <div class="entrybody"><p>At the moment I&#8217;m doing a lot of work with Microsoft Active Directory and PHP. I&#8217;m building a few tools in PHP which reads data out of AD.</p>
<p>Now one of the things I wanted to read out was to see if the account was locked or if its password never expired. I couldn&#8217;t find these entries in AD but after searching those entries are stored in &#8220;useraccountcontrol&#8221;. But when I looked it was just a number. How does that number tell you if the account is locked?</p>
<p><a href="http://msdn.microsoft.com/en-us/library/ms680832(VS.85).aspx" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://msdn.microsoft.com']);">http://msdn.microsoft.com/en-us/library/ms680832(VS.85).aspx</a></p>
<p>On the above link is how that number is generated and once I understood that I got to work on writing a PHP script which translates that number into something more usable. Once I wrote the script I put it up on the Hot Scripts Forum to see if the code I wrote could be improved on and optimised. Here is what they came back with:</p>
<p>[PHP]<br />
$userAccountArray = array(<br />
  &#8216;ADS_UF_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION&#8217; => 0,<br />
  &#8216;ADS_UF_PASSWORD_EXPIRED&#8217; => 0,<br />
  &#8216;ADS_UF_DONT_REQUIRE_PREAUTH&#8217; => 0,<br />
  &#8216;ADS_UF_USE_DES_KEY_ONLY&#8217; => 0,<br />
  &#8216;ADS_UF_NOT_DELEGATED&#8217; => 0,<br />
  &#8216;ADS_UF_TRUSTED_FOR_DELEGATION&#8217; => 0,<br />
  &#8216;ADS_UF_SMARTCARD_REQUIRED&#8217; => 0,<br />
  &#8216;ADS_UF_MNS_LOGON_ACCOUNT&#8217; => 0,<br />
  &#8216;ADS_UF_DONT_EXPIRE_PASSWD&#8217; => 0,<br />
  &#8216;NOT_USED_8000&#8242; => 0,<br />
  &#8216;NOT_USED_4000&#8242; => 0,<br />
  &#8216;ADS_UF_SERVER_TRUST_ACCOUNT&#8217; => 0,<br />
  &#8216;ADS_UF_WORKSTATION_TRUST_ACCOUNT&#8217; => 0,<br />
  &#8216;ADS_UF_INTERDOMAIN_TRUST_ACCOUNT&#8217; => 0,<br />
  &#8216;ADS_UF_NORMAL_ACCOUNT&#8217; => 0,<br />
  &#8216;ADS_UF_TEMP_DUPLICATE_ACCOUNT&#8217; => 0,<br />
  &#8216;ADS_UF_ENCRYPTED_TEXT_PASSWORD_ALLOWED&#8217; => 0,<br />
  &#8216;ADS_UF_PASSWD_CANT_CHANGE&#8217; => 0,<br />
  &#8216;ADS_UF_PASSWD_NOTREQD&#8217; => 0,<br />
  &#8216;ADS_UF_LOCKOUT&#8217; => 0,<br />
  &#8216;ADS_UF_HOMEDIR_REQUIRED&#8217; => 0,<br />
  &#8216;NOT_USED_4&#8242; => 0,<br />
  &#8216;ADS_UF_ACCOUNTDISABLE&#8217; => 0,<br />
  &#8216;ADS_UF_SCRIPT&#8217; => 0<br />
);</p>
<p>function ADUserAccountControl($val) {<br />
	global $userAccountArray;<br />
	$x = pow(2, count($userAccountArray) &#8211; 1);<br />
	foreach($userAccountArray as $k => $v) {<br />
		if(($val &#8211; $x) >= 0){<br />
			$userAccountArray[$k] = 1;<br />
			$val -= $x;<br />
		} else {<br />
			$userAccountArray[$k] = 0;<br />
		}<br />
		$x = $x / 2;<br />
	}<br />
}<br />
[/PHP]</p>
<p>Simply pass your useraccountcontrol value to the function and read the results out of the array.</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=432.html#respond" title="Comment on PHP &#8211; Active Directory &#8211; Reading UserAccountControl"><span class="dsq-postid" rel="432 http://l3rady.com/?p=432"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2009/09/14/php-active-directory-reading-useraccountcontrol/"
    dc:identifier="http://l3rady.com/blog/2009/09/14/php-active-directory-reading-useraccountcontrol/"
    dc:title="PHP &#8211; Active Directory &#8211; Reading UserAccountControl"
    trackback:ping="http://l3rady.com/blog/2009/09/14/php-active-directory-reading-useraccountcontrol/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">25 February 2009</h2>-->
      <h3 class="entrytitle" id="post-416"><a href="../../index.html%3Fp=416.html" rel="bookmark">WSUS &#8211; Unable to connect to the server yourserver.yourdomain</a></h3>
      <div class="entrymeta">February 25th 2009 | Posted to <a href="../../blog/category/inner-geek/index.html" title="View all posts in Inner Geek" rel="category tag">Inner Geek</a> </div>
      <div class="entrybody"><p>Recently at work we installed the latest version of <a href="http://technet.microsoft.com/en-us/wsus/default.aspx" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://technet.microsoft.com']);" target="_blank">Windows Server Update Services (WSUS)</a> but we had a few issues with installing it. When installing we were getting the error: Unable to connect to the server yourserver.yourdomain. My work colleague spent hours searching forums and help topics but nowhere had the answer. In the end all it appeared to be was drive compression! WSUS will not install or function if the place where it stores the updates is compressed. To turn off, right click the folder where you&#8217;re installing to, properties, click advanced button. On the new window that opens un-tick the box &#8220;Compress content to save disk space&#8221;. You will notice folders and files that are compressed when the names are in blue. Hope this helps you.</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=416.html#respond" title="Comment on WSUS &#8211; Unable to connect to the server yourserver.yourdomain"><span class="dsq-postid" rel="416 http://l3rady.com/?p=416"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2009/02/25/wsus-unable-to-connect-to-the-server-yourserveryourdomain/"
    dc:identifier="http://l3rady.com/blog/2009/02/25/wsus-unable-to-connect-to-the-server-yourserveryourdomain/"
    dc:title="WSUS &#8211; Unable to connect to the server yourserver.yourdomain"
    trackback:ping="http://l3rady.com/blog/2009/02/25/wsus-unable-to-connect-to-the-server-yourserveryourdomain/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">7 October 2008</h2>-->
      <h3 class="entrytitle" id="post-394"><a href="../../index.html%3Fp=394.html" rel="bookmark">Make Portable/Removable Hard Drive/Memory Stick Bootable</a></h3>
      <div class="entrymeta">October 07th 2008 | Posted to <a href="../../blog/category/inner-geek/index.html" title="View all posts in Inner Geek" rel="category tag">Inner Geek</a> </div>
      <div class="entrybody"><p>I&#8217;m not going to babble on here because if you have found this post you just want to know how it’s done.</p>
<p>Here is what you need:</p>
<p>A portable/removable hard drive/memory stick (USB) that is capable of being made into a bootable device. Some of these devices cant be made bootable; if you are unsure if yours can be made bootable then contact the manufacture. I have successfully made portable Maxtor, Western Digital and Freecom USB hard drives bootable ranging from 40GB to 320GB in size. I have also made a handful of generic USB sticks bootable ranging from 512MB to 8GB in size so it should be unlikely you will have a device that cannot be made bootable.</p>
<p>You will need a computer that can boot from a USB device.</p>
<p>You will also need an existing boot disk of some sort. I find what works best is a Windows 95 boot disk. If you are going to use a floppy or CD then you can get images from http://www.allbootdisks.com/</p>
<p>So now lets get prepped! Now we are going to use a fat32 partition for our boot partition. Now the max size for fat32 partition on Windows 95 is, have a guess, 32GB so if you have a portable drive that is 320GB then you will need 2 partitions. The second partition can be NTFS and can fill up the rest of the drive, but the first partition must be fat32 less than 32GB. Just as a side note http://support.microsoft.com/kb/140365 will tell you what cluster size to use depending on what size your partition is. </p>
<p>Now have you set up your Windows 95 boot disk? If you have downloaded the ISO then burn it to a CD and if you have downloaded the diskette image then run it and get the image on the floppy disk.</p>
<p>Shutdown your PC and insert floppy/CD and plug in your USB device. I would recommend you unplug any other hard drives in your system so that you don’t have any confusion later on and so that you don’t accidentally break your windows install on your PC.</p>
<p>Tell your PC to boot from floppy or CD and wait for Windows 95 to start. You will be presented with:</p>
<p>[code]A:>[/code]</p>
<p>Now type fdisk and hit enter:</p>
<p>[code]A:>fdisk[/code]</p>
<p>What you are going to do here is set your USB device to the active partition this should be under option 2 on fdisk (This is the FAT32 partition). Once you have set the partition to active you should now see a capital A on that partition. Press escape a couple of times and you will be prompted to reboot. So go ahead and do that, then boot back into your floppy or CD.</p>
<p>Now your USB drive should be set as C: so type dir C:</p>
<p>[code]A:>dir C:[/code]</p>
<p>You should see no files and it should tell you the space available of that drive, it should match the size of the partition. Now lets copy the contents of the floppy or CD to your USB device. Type copy *.* C:\*</p>
<p>[code]A:>copy *.* C:\*[/code]</p>
<p>Once that has coppied type in sys C:</p>
<p>[code]A:>sys C:[/code]</p>
<p>This copies the system info to the USB device. Now just need to set up a Master Boot Record so type fdisk /mbr</p>
<p>[code]A:>fdisk /mbr[/code]</p>
<p>Ok so we are all done now, so reboot and try booting up off your USB device. Now you should see your usual A:&amp;amp;gt; just as if you booted off CD or Floppy.</p>
<p>So that’s about it, you can load up a load of useful DOS utilities. If your using a hard drive with an NTFS partition you might want to put on your new bootable USB device a program called NTFS4DOS. This will give you access to NTFS partitions from DOS. Also another handy utility is Ghost. This will allow you to take an image of any hard drive and put it in one handy file. With that one file you can then restore that image, ideal for taking an image of a fresh install of and operating system and then restoring when you come to reinstall. This will save you having to redo the windows install and reinstall all your software, patches and user preferences.</p>
<p>So there we have it, if you have any problems or want to know more just leave a comment and I will get back to you ASAP.</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=394.html#respond" title="Comment on Make Portable/Removable Hard Drive/Memory Stick Bootable"><span class="dsq-postid" rel="394 http://l3rady.com/?p=394"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2008/10/07/make-portableremovable-hard-drivememory-stick-bootable/"
    dc:identifier="http://l3rady.com/blog/2008/10/07/make-portableremovable-hard-drivememory-stick-bootable/"
    dc:title="Make Portable/Removable Hard Drive/Memory Stick Bootable"
    trackback:ping="http://l3rady.com/blog/2008/10/07/make-portableremovable-hard-drivememory-stick-bootable/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">1 September 2008</h2>-->
      <h3 class="entrytitle" id="post-353"><a href="../../index.html%3Fp=353.html" rel="bookmark">Windows XP explorer.exe missing or corrupt</a></h3>
      <div class="entrymeta">September 01st 2008 | Posted to <a href="../../blog/category/inner-geek/index.html" title="View all posts in Inner Geek" rel="category tag">Inner Geek</a> </div>
      <div class="entrybody"><p>So here’s a new one, recently at work we have had a number of XP Pro machines login but failed to load up explorer. The first thing you would attempt would be to start task manager (Ctrl+Alt+Delete), start a new task and start explorer. Now when we did that we were getting an error saying that explorer was missing or corrupt. So we opened up CMD to browse the Windows directory only to find explorer was there and seemed fine…</p>
<p>We came across a fix to rename explorer to explorer2.exe and update the registry with regedit to point to the new explorer2.exe. This worked and proved there was nothing corrupt or missing but it wasn’t an ideal solution as it was quite long winded.</p>
<p>The problem started to appear with more and more PC’s on our network, this is no longer a coincidence. The problem is happening on different service packs of SP so we know its not an SP related issue. After doing a bit of searching around I found something called FixO. After running this and rebooting the PC explorer was now working great and it kept explorer as same name etc. You can get it here: <a href="../../wp-content/uploads/2008/09/fixo.zip" onclick="javascript:_gaq.push(['_trackPageview','/yoast-ga/download/http://l3rady.com/wp-content/uploads/2008/09/fixo.zip']);">FixO &#8211; Repair explorer.exe</a></p>
<p>Still this was a long way around script but at least it can be scripted into the login script. Anyway one of my work colleges found another solution, which seems to cure the problem but no idea why. It’s a simple one-line registry edit.</p>
<p>Open notepad and put the following in:</p>
<p>[html]<br />
Windows Registry Editor Version 5.00</p>
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\explorer.exe]<br />
&#8220;Debugger&#8221;=-<br />
[/html]</p>
<p>Save the file as a reg file. Then run this file in regedit, this simply removes the offending registry key that is causing problems. If you want you can just get the file here: <a href="../../wp-content/uploads/2008/09/fixnodtop.reg" >Reg Fix &#8211; Fix No Desktop</a></p>
<p>So we still don’t know what’s causing this but we do have a temporary solution.</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=353.html#respond" title="Comment on Windows XP explorer.exe missing or corrupt"><span class="dsq-postid" rel="353 http://l3rady.com/?p=353"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2008/09/01/windows-xp-explorerexe-missing-or-corrupt/"
    dc:identifier="http://l3rady.com/blog/2008/09/01/windows-xp-explorerexe-missing-or-corrupt/"
    dc:title="Windows XP explorer.exe missing or corrupt"
    trackback:ping="http://l3rady.com/blog/2008/09/01/windows-xp-explorerexe-missing-or-corrupt/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">14 August 2008</h2>-->
      <h3 class="entrytitle" id="post-352"><a href="../../index.html%3Fp=352.html" rel="bookmark">Javascript Same Height Div&#8217;s Update</a></h3>
      <div class="entrymeta">August 14th 2008 | Posted to <a href="../../blog/category/code-and-snippets/javascript/index.html" title="View all posts in JavaScript" rel="category tag">JavaScript</a> </div>
      <div class="entrybody"><p>A while back I posted a way of making same height div’s but came across an issue when padding was involved. Well I’ve modified my code to take into account padding. Now the obvious thing to do would be to be to check padding on a div and subtract it from the height, but it’s not that easy. You would have to check three things: padding, paddingTop and paddingBottom. For some reason when I was checking padding I couldn’t get a value from JavaScript, this had me really stumped but after a nights sleep I came up with a better and more simpler way of sorting the padding issue. This is to let the code run and let it re-height the div’s and let the padding mess things up then run the same thing again and check for height differences from last time we checked. Oooohhh look the height has gone up 10px from last time thanks to a padding of 5px on the div. Now we know there is 10px of padding lets remove it. Sorted!</p>
<p>JavaScript Code:<br />
[js]<br />
function sameHeight(divs) // Bring in an array of your divs<br />
{<br />
var highest = 0;<br />
var heighttu = 0;<br />
for(i = 0; i < divs.length; i++) // Loop through the divs
{
// Check to see if this div is the highest?
if(document.getElementById(divs[i]).offsetHeight > highest)<br />
{<br />
// Yes its the highest so set the highest value to this div&#8217;s height<br />
highest = document.getElementById(divs[i]).offsetHeight;<br />
}<br />
}<br />
// Loop through divs and set their hieght all the same<br />
for(i = 0; i < divs.length; i++)
{
document.getElementById(divs[i]).style.height = highest+"px";
}
// now get offset hieght again and we may found we have gone higher this is because of padding
if(document.getElementById(divs[0]).offsetHeight > highest)<br />
{<br />
// correct the height<br />
highest = highest &#8211; (document.getElementById(divs[0]).offsetHeight &#8211; highest);<br />
// Correct divs<br />
for(i = 0; i < divs.length; i++)
{
document.getElementById(divs[i]).style.height = highest+&#8221;px&#8221;;
}
}
}[/js]
</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=352.html#respond" title="Comment on Javascript Same Height Div&#8217;s Update"><span class="dsq-postid" rel="352 http://l3rady.com/?p=352"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2008/08/14/javascript-same-height-divs-update/"
    dc:identifier="http://l3rady.com/blog/2008/08/14/javascript-same-height-divs-update/"
    dc:title="Javascript Same Height Div&#8217;s Update"
    trackback:ping="http://l3rady.com/blog/2008/08/14/javascript-same-height-divs-update/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">5 June 2008</h2>-->
      <h3 class="entrytitle" id="post-90"><a href="../../index.html%3Fp=90.html" rel="bookmark">Javascript Same Height Div&#8217;s</a></h3>
      <div class="entrymeta">June 05th 2008 | Posted to <a href="../../blog/category/code-and-snippets/javascript/index.html" title="View all posts in JavaScript" rel="category tag">JavaScript</a> </div>
      <div class="entrybody"><p>Recently I had to make some divs the same height. Usually I would just pad the bottom of a div with page breaks but I couldn’t do that this time round as the page content is dynamic and the height of the divs could change.</p>
<p>First thing I did was look online for answers and sure enough there were solutions but looking at them they seemed over complicated so I decided to write my own solution.</p>
<p>Javascript Code:</p>
<p>Update at: <a href="../../2008/08/14/javascript-same-height-divs-update/index.html" >http://l3rady.com/2008/08/14/javascript-same-height-divs-update/</a></p>
<p>Simply pass an array of your divs to the function. Easy peasy&#8230;.</p>
<p>Just an extra word of warning&#8230; Be aware of using padding on the blocks you pass to this function. If the paddings are different in each block then they may not end up being the same height. Although you could modify the function to check for the use of padding and alter the heights accordingly.</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=90.html#respond" title="Comment on Javascript Same Height Div&#8217;s"><span class="dsq-postid" rel="90 http://l3rady.com/?p=90"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2008/06/05/javascript-same-height-divs/"
    dc:identifier="http://l3rady.com/blog/2008/06/05/javascript-same-height-divs/"
    dc:title="Javascript Same Height Div&#8217;s"
    trackback:ping="http://l3rady.com/blog/2008/06/05/javascript-same-height-divs/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">28 May 2008</h2>-->
      <h3 class="entrytitle" id="post-89"><a href="../../index.html%3Fp=89.html" rel="bookmark">Getting Windows HDD usage with PHP and SNMP</a></h3>
      <div class="entrymeta">May 28th 2008 | Posted to <a href="../../blog/category/code-and-snippets/php/index.html" title="View all posts in PHP" rel="category tag">PHP</a> </div>
      <div class="entrybody"><p>At work a couple of months back I was faced with a problem that many of our servers would run out of hard drive space without us knowing and that would cause the server to hang and/or stop responding. So I did a bit of research and came across. This little utilility would run on the server in command line and tell you what drives were available and some info of the drives like space used and available. Well with this I would echo out the data to a text file and send that across to a common holding ground. Then from there get my web server to constantly scan this folder for new logs. This method worked but it had its issues.</p>
<p>Well yesterday at work I was playing around with SNMP and after finding a site with <a href="http://snmpboy.msft.net/pub/w2kmibs/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://snmpboy.msft.net']);">W2K MIBS</a> I found lots of info you can pull from the server. Now I was already familiar with SNMP in PHP thanks to their <a href="http://uk.php.net/snmp" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','uk.php.net']);">documentation</a> on their site. So using their snmpwalk function I was able to pull the relevant data to get HDD usage info.</p>
<p>[php]<br />
$names = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.3&#8242;);<br />
$used = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.6&#8242;);<br />
$total = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.5&#8242;);<br />
$alloc = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.4&#8242;);<br />
[/php]</p>
<p>Now that would give me an array of drive names, space used on those drives, total space available on those drives and the allocation units. Now the allocation units I didn&#8217;t realize I needed as I thought the numbers given in used and total were just measured in bytes but they aren&#8217;t. The numbers in used and total are how many blocks of allocation size (if that makes sense). So to get the true byte value from used and total you need to multiply them by the allocation size number.</p>
<p><em>25599569 * 4096 = 104855834624B = 97.65GB</em></p>
<p>So there you have it. Now you know how to get HDD usage from your server using PHP and SNMP.</p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=89.html#respond" title="Comment on Getting Windows HDD usage with PHP and SNMP"><span class="dsq-postid" rel="89 http://l3rady.com/?p=89"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2008/05/28/getting-windows-hdd-usage-with-php-and-snmp/"
    dc:identifier="http://l3rady.com/blog/2008/05/28/getting-windows-hdd-usage-with-php-and-snmp/"
    dc:title="Getting Windows HDD usage with PHP and SNMP"
    trackback:ping="http://l3rady.com/blog/2008/05/28/getting-windows-hdd-usage-with-php-and-snmp/trackback/" />
</rdf:RDF>-->
    </div>
      <div class="entry">
      <!--<h2 class="entrydate">7 February 2008</h2>-->
      <h3 class="entrytitle" id="post-69"><a href="../../index.html%3Fp=69.html" rel="bookmark">PHP File Upload Progress Bar Part 2</a></h3>
      <div class="entrymeta">February 07th 2008 | Posted to <a href="../../blog/category/code-and-snippets/php/index.html" title="View all posts in PHP" rel="category tag">PHP</a> </div>
      <div class="entrybody"><p>After further investigation PHP 5.2.0 now allows you to use the APC (Alternative PHP Cache) addition with the ability to track the progress of uploads. Within windows it is as simply adding the dll extension to your php.ini and putting some configs there to. With Linux I&#8217;m not too sure how you add this extension as I don&#8217;t know Linux well. But anyway below is some nice and easy documentation on this.</p>
<p><a href="http://www.ibm.com/developerworks/library/os-php-v525/index.html" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://www.ibm.com']);">PHP File Upload Progress Bar</a></p>
        <p class="comments_link">
        <a href="../../index.html%3Fp=69.html#respond" title="Comment on PHP File Upload Progress Bar Part 2"><span class="dsq-postid" rel="69 http://l3rady.com/2008/02/07/php-file-upload-progress-bar-part-2/"><img src="../../wp-content/themes/alphaready/images/comments.gif"  title="comments" alt="*" /> Comments(0)</span></a>        </p>
      </div>
      <!--<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://l3rady.com/blog/2008/02/07/php-file-upload-progress-bar-part-2/"
    dc:identifier="http://l3rady.com/blog/2008/02/07/php-file-upload-progress-bar-part-2/"
    dc:title="PHP File Upload Progress Bar Part 2"
    trackback:ping="http://l3rady.com/blog/2008/02/07/php-file-upload-progress-bar-part-2/trackback/" />
</rdf:RDF>-->
    </div>
    <div class="entryother"><a href="../../index.html" >&laquo; Previous Page</a> &#8212; <a href="../3/index.html" >Next Page &raquo;</a></div>
  </div>
  <br style="clear:both" />
<!-- begin footer -->
  </div>
</div>
<div id="footer">
  <p><a href="http://www.alphaready.com"><img src="../../wp-content/themes/alphaready/images/ARfooter.jpg" alt="Alpha Ready" title="AlphavReady" border="0" /></a></p>
  <p>Copyright &copy; 2008-2015 <a href="http://www.alphaready.com">Alpha Ready Ltd</a>. All rights reserved.</p>
</div>
    <script type="text/javascript">
    // <![CDATA[
        var disqus_shortname = 'l3rady';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('rel'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) url = url[0];
                    else url = url[1]
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    //]]>
    </script>
<script type='text/javascript'>
/* <![CDATA[ */
var MTBrushParams = {"baseUrl":"http:\/\/l3rady.com\/wp-content\/plugins\/syntax-highlighter-mt"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/syntax-highlighter-mt/brushTypes.js%3Fver=2.2.4'></script>
</body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced
Object Caching 854/946 objects using disk

 Served from: l3rady.com @ 2015-12-30 23:27:42 by W3 Total Cache -->