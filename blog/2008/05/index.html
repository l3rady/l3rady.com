<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="distribution" content="global"/>
<meta name="robots" content="follow, all"/>
<meta name="language" content="en"/>
<title>
Brady &raquo; 2008 &raquo; May</title>
<meta name="generator" content="WordPress 3.9.9"/>
 
<link rel="shortcut icon" href="http://l3rady.com/blog/2008/05/wp-content/favicon.ico" type="image/x-icon"/>
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="../../../feed/rss/index.html"/>
<link rel="alternate" type="text/xml" title="RSS .92" href="../../../feed/rss/index.html"/>
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="../../../feed/atom/index.html"/>
<link rel="pingback" href="../../../xmlrpc.php"/>
<link rel='archives' title='March 2011' href='../../2011/03/index.html'/>
<link rel='archives' title='January 2011' href='../../2011/01/index.html'/>
<link rel='archives' title='October 2010' href='../../2010/10/index.html'/>
<link rel='archives' title='September 2010' href='../../2010/09/index.html'/>
<link rel='archives' title='October 2009' href='../../2009/10/index.html'/>
<link rel='archives' title='September 2009' href='../../2009/09/index.html'/>
<link rel='archives' title='February 2009' href='../../2009/02/index.html'/>
<link rel='archives' title='October 2008' href='../10/index.html'/>
<link rel='archives' title='September 2008' href='../09/index.html'/>
<link rel='archives' title='August 2008' href='../08/index.html'/>
<link rel='archives' title='June 2008' href='../06/index.html'/>
<link rel='archives' title='May 2008' href='index.html'/>
<link rel='archives' title='February 2008' href='../02/index.html'/>
<script type="text/javascript">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.5 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-25211555-1']);
				            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
<link rel='stylesheet' id='mt-shcore-style-css' href='../../../wp-content/plugins/syntax-highlighter-mt/styles/shCore.css%3Fver=2.2.4.css' type='text/css' media='all'/>
<link rel='stylesheet' id='mt-theme-style-css' href='../../../wp-content/plugins/syntax-highlighter-mt/styles/shThemeDefault.css%3Fver=2.2.4.css' type='text/css' media='all'/>
<script type='text/javascript' src='../../../wp-content/plugins/syntax-highlighter-mt/scripts/shCore.js%3Fver=2.2.4'></script>
<script type='text/javascript' src='../../../wp-content/plugins/syntax-highlighter-mt/scripts/shAutoloader.js%3Fver=2.2.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc.php%3Frsd"/>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml"/>
<meta name="generator" content="WordPress 3.9.9"/>
<link rel="StyleSheet" href="../../../wp-content/themes/alphaready/style/resetCSS.css" type="text/css"/>
<link rel="StyleSheet" href="../../../wp-content/themes/alphaready/style/alpha.css" type="text/css"/>
<!--[if lte IE 7.0]><link type="text/css" rel="stylesheet" href="/wp-content/themes/alphaready/style/alphaie7.css" /><![endif]-->
<!--[if lte IE 6.0]><link type="text/css" rel="stylesheet" href="/wp-content/themes/alphaready/style/alphaie6.css" /><![endif]-->
</head>
<body>
<div id="container">
<a href="../../../index.html"><img src="../../../wp-content/themes/alphaready/images/headerlogo.jpg" alt="Brady" title="Brady" border="0"/></a>
<div id="header-container">
<div id="slogan"><img src="../../../wp-content/themes/alphaready/images/slogan.png" alt="A moan, a groan, my life story and how me, a technically minded person just can&#039;t seem to fit in with anybody." title="A moan, a groan, my life story and how me, a technically minded person just can&#039;t seem to fit in with anybody."/></div>
<div id="nav-container">
<ul id="navigation">
<li class='home' id='selected'><a href="../../../index.html">HOME</a></li>
<li class='about'><a href="../../../about-me.html">ABOUT ME</a></li>
<li class='webmail'><a href="http://webmail.alphaready.com">WEBMAIL</a></li>
<li class='sms'><a href="http://sms.alphaready.com">SMS GATEWAY</a></li>
<li class='proxy'><a href="http://proxy.alphaready.com">PROXY</a></li>
</ul>
<a href="../../../cigarette.php.html"> </a>
</div>
</div>
<div id="content"> <div id="sidebar">
<ul id="ulside">
<li><h2 id="side01">ARCHIVES</h2>
<ul>
<li><a href='../../2011/03/index.html'>March 2011</a></li>
<li><a href='../../2011/01/index.html'>January 2011</a></li>
<li><a href='../../2010/10/index.html'>October 2010</a></li>
<li><a href='../../2010/09/index.html'>September 2010</a></li>
<li><a href='../../2009/10/index.html'>October 2009</a></li>
<li><a href='../../2009/09/index.html'>September 2009</a></li>
<li><a href='../../2009/02/index.html'>February 2009</a></li>
<li><a href='../10/index.html'>October 2008</a></li>
<li><a href='../09/index.html'>September 2008</a></li>
<li><a href='../08/index.html'>August 2008</a></li>
<li><a href='../06/index.html'>June 2008</a></li>
<li><a href='index.html'>May 2008</a></li>
<li><a href='../02/index.html'>February 2008</a></li>
</ul>
</li>
<li><h2 id="side02">CATEGORIES</h2>
<ul>
<li class="cat-item cat-item-8"><a href="../../category/code-and-snippets/index.html" title="View all posts filed under Code and Snippets">Code and Snippets</a> (14)
<ul class='children'>
<li class="cat-item cat-item-18"><a href="../../category/code-and-snippets/css/index.html" title="View all posts filed under CSS">CSS</a> (1)
</li>
<li class="cat-item cat-item-10"><a href="../../category/code-and-snippets/html/index.html" title="View all posts filed under HTML">HTML</a> (3)
</li>
<li class="cat-item cat-item-11"><a href="../../category/code-and-snippets/javascript/index.html" title="View all posts filed under JavaScript">JavaScript</a> (3)
</li>
<li class="cat-item cat-item-9"><a href="../../category/code-and-snippets/php/index.html" title="View all posts filed under PHP">PHP</a> (8)
</li>
</ul>
</li>
<li class="cat-item cat-item-16"><a href="../../category/how-to/index.html" title="View all posts filed under How to">How to</a> (1)
</li>
<li class="cat-item cat-item-6"><a href="../../category/inner-geek/index.html" title="Don&#039;t enter here if you want some lite reading. This place is purly my inner geek talking.">Inner Geek</a> (4)
</li>
<li class="cat-item cat-item-14"><a href="../../category/software/index.html" title="View all posts filed under Software">Software</a> (2)
</li>
</ul>
</li>
<li><h2 id="side03">META</h2>
<ul>
<li><a href="http://feeds.feedburner.com/l3rady/WyQw" title="Syndicate this site using RSS"><abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="../../../wp-login.php.html">Log in</a></li>
</ul>
</li>
</ul>
</div>
<div class="arc"><h2>Archive for May, 2008</h2></div>
<div id="main-content">
<div class="entry">
 
<h3 class="entrytitle" id="post-89"><a href="../../../index.html%3Fp=89.html" rel="bookmark">Getting Windows HDD usage with PHP and SNMP</a></h3>
<div class="entrymeta">May 28th 2008 | Posted to <a href="../../category/code-and-snippets/php/index.html" title="View all posts in PHP" rel="category tag">PHP</a> </div>
<div class="entrybody"><p>At work a couple of months back I was faced with a problem that many of our servers would run out of hard drive space without us knowing and that would cause the server to hang and/or stop responding. So I did a bit of research and came across. This little utilility would run on the server in command line and tell you what drives were available and some info of the drives like space used and available. Well with this I would echo out the data to a text file and send that across to a common holding ground. Then from there get my web server to constantly scan this folder for new logs. This method worked but it had its issues.</p>
<p>Well yesterday at work I was playing around with SNMP and after finding a site with <a href="http://snmpboy.msft.net/pub/w2kmibs/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://snmpboy.msft.net']);">W2K MIBS</a> I found lots of info you can pull from the server. Now I was already familiar with SNMP in PHP thanks to their <a href="http://uk.php.net/snmp" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','uk.php.net']);">documentation</a> on their site. So using their snmpwalk function I was able to pull the relevant data to get HDD usage info.</p>
<p>[php]<br/>
$names = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.3&#8242;);<br/>
$used = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.6&#8242;);<br/>
$total = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.5&#8242;);<br/>
$alloc = snmpwalk($row['ip'], &#8220;public&#8221;, &#8216;.1.3.6.1.2.1.25.2.3.1.4&#8242;);<br/>
[/php]</p>
<p>Now that would give me an array of drive names, space used on those drives, total space available on those drives and the allocation units. Now the allocation units I didn&#8217;t realize I needed as I thought the numbers given in used and total were just measured in bytes but they aren&#8217;t. The numbers in used and total are how many blocks of allocation size (if that makes sense). So to get the true byte value from used and total you need to multiply them by the allocation size number.</p>
<p><em>25599569 * 4096 = 104855834624B = 97.65GB</em></p>
<p>So there you have it. Now you know how to get HDD usage from your server using PHP and SNMP.</p>
<p class="comments_link">
<a href="../../../index.html%3Fp=89.html#respond" title="Comment on Getting Windows HDD usage with PHP and SNMP"><span class="dsq-postid" rel="89 http://l3rady.com/?p=89"><img src="../../../wp-content/themes/alphaready/images/comments.gif" title="comments" alt="*"/> Comments(0)</span></a> </p>
</div>
 
</div>
<div class="entryother"></div>
</div>
<br style="clear:right"/>
 
</div>
</div>
<div id="footer">
<p><a href="http://www.alphaready.com"><img src="../../../wp-content/themes/alphaready/images/ARfooter.jpg" alt="Alpha Ready" title="AlphavReady" border="0"/></a></p>
<p>Copyright &copy; 2008-2015 <a href="http://www.alphaready.com">Alpha Ready Ltd</a>. All rights reserved.</p>
</div>
<script type="text/javascript">
    // <![CDATA[
        var disqus_shortname = 'l3rady';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('rel'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) url = url[0];
                    else url = url[1]
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    //]]>
    </script>
<script type='text/javascript'>
/* <![CDATA[ */
var MTBrushParams = {"baseUrl":"http:\/\/l3rady.com\/wp-content\/plugins\/syntax-highlighter-mt"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../wp-content/plugins/syntax-highlighter-mt/brushTypes.js%3Fver=2.2.4'></script>
</body>
</html>
